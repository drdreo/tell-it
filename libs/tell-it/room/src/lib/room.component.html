<div class="page-container">
    @if (
        {
            user: user$ | async,
            users: users$ | async,
            gameStatus: gameStatus$ | async,
            offline: offline$ | async,
            disconnected: disconnected$ | async,
            turnTimer: turnTimer$ | async,
            finishVotes: finishVotes$ | async,
            story: story$ | async,
            finalStories: finalStories$ | async
        };
        as vm
    ) {
        @if (vm.offline || vm.disconnected) {
            <div class="connection-status">
                {{ vm.offline }}
                {{ vm.disconnected }}
            </div>
        }

        @switch (vm.gameStatus) {
            @case ("waiting") {
                <tell-it-waiting-room
                    [roomName]="roomName"
                    [users]="vm.users"
                    [user]="vm.user"
                    (startGame)="startGame()">
                </tell-it-waiting-room>
            }
            @case ("started") {
                <tell-it-game-in-progress
                    [users]="vm.users"
                    [user]="vm.user"
                    [story]="vm.story"
                    [turnTimer]="vm.turnTimer"
                    [finishVotes]="vm.finishVotes"
                    (submitText)="submitText($event)"
                    (voteFinish)="voteFinish()">
                </tell-it-game-in-progress>
            }
            @case ("ended") {
                <tell-it-game-ended
                    [finalStories]="vm.finalStories"
                    (restart)="restart()"
                    (loadFinalStories)="loadFinalStories()">
                </tell-it-game-ended>
            }
        }
    }
</div>
